2025-11-24 22:41:28,117 - INFO - __main__ - Starting ICD-10 WHO pipeline...
2025-11-24 22:41:28,118 - INFO - root - Using existing ICD-10 file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-24 22:41:28,123 - INFO - root - Loaded 5 rows from icd10who_codes_2024.csv
2025-11-24 22:41:28,125 - INFO - root - Validating 5 ICD-10 rows
2025-11-24 22:41:28,129 - INFO - root - Valid ICD-10 rows: 3
2025-11-24 22:41:28,129 - INFO - root - Invalid ICD-10 rows (format issues): 2
2025-11-24 22:41:28,135 - INFO - root - Final clean dataset contains 3 rows
2025-11-24 22:41:28,135 - INFO - __main__ - ‚úÖ ICD-10 WHO processing completed successfully
2025-11-25 14:22:52,532 - INFO - root - Using existing file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-29 19:37:47,411 - INFO - root - Using existing file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-29 19:40:08,801 - INFO - root - Using existing file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-29 19:43:15,190 - INFO - root - Using existing file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-30 19:17:19,481 - INFO - root - Using existing file: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-30 19:21:47,521 - INFO - root - ============================================================
2025-11-30 19:21:47,521 - INFO - root - Starting ICD-10 WHO processor
2025-11-30 19:21:47,521 - INFO - root - ============================================================
2025-11-30 19:21:48,269 - INFO - root - üåê Attempting online download first: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-30 19:21:48,270 - INFO - root -    Source: HARDCODED URL
2025-11-30 19:21:48,270 - INFO - root -    URL: https://icd.who.int/browse10/2025/en/Download/GetICD10CSV
2025-11-30 19:21:48,271 - INFO - root -    Download attempt 1/3...
2025-11-30 19:21:48,589 - WARNING - root -    Download attempt 1 failed: HTTPSConnectionPool(host='icd.who.int', port=443): Max retries exceeded with url: /browse10/2025/en/Download/GetICD10CSV (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1028)')))
2025-11-30 19:21:48,590 - INFO - root -    Download attempt 2/3...
2025-11-30 19:21:48,919 - WARNING - root -    Download attempt 2 failed: HTTPSConnectionPool(host='icd.who.int', port=443): Max retries exceeded with url: /browse10/2025/en/Download/GetICD10CSV (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1028)')))
2025-11-30 19:21:48,919 - INFO - root -    Download attempt 3/3...
2025-11-30 19:21:49,235 - WARNING - root -    Download attempt 3 failed: HTTPSConnectionPool(host='icd.who.int', port=443): Max retries exceeded with url: /browse10/2025/en/Download/GetICD10CSV (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1028)')))
2025-11-30 19:21:49,236 - WARNING - root - ‚ùå ONLINE DOWNLOAD FAILED - All download attempts exhausted
2025-11-30 19:21:49,236 - WARNING - root -    Last error: HTTPSConnectionPool(host='icd.who.int', port=443): Max retries exceeded with url: /browse10/2025/en/Download/GetICD10CSV (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1028)')))
2025-11-30 19:21:49,236 - INFO - root -    Falling back to local file check...
2025-11-30 19:21:49,236 - INFO - root - üìÅ Using local file fallback: /Users/lui/Desktop/Develop/python/codex-sync-etl/input/icd10who_codes_2024.csv
2025-11-30 19:21:49,237 - INFO - root -    Source: LOCAL FILE (online download failed or unavailable)
